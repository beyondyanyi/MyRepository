yum install ntp

#### 1.服务器配置

```
vi /etc/ntp.conf

##允许192.168.0.0网段所有机器访问
restrict 192.168.0.0 mask 255.255.0.0 nomodify
##允许156.14.15.145访问
restrict - 156.14.15.145

systemctl start ntpd
```





```
restrict参数：
	ignore  ：关闭所有的 NTP 联机服务

    nomodify：客户端不能更改服务端的时间参数，但是客户端可以通过服务端进行网络校时。

    notrust ：客户端除非通过认证，否则该客户端来源将被视为不信任子网

    noquery ：不提供客户端的时间查询：用户端不能使用ntpq，ntpc等命令来查询ntp服务器

    notrap ：不提供trap远端登陆：拒绝为匹配的主机提供模式 6 控制消息陷阱服务。陷阱服务是 ntpdq 控制消息协议的子系统，用于远程事件日志记录程序。

    nopeer ：用于阻止主机尝试与服务器对等，并允许欺诈性服务器控制时钟

    kod ： 访问违规时发送 KoD 包。

    restrict -6 表示IPV6地址的权限设置。	
```



#### 2.客户端配置

```
vi /etc/ntp.conf

systemctl enable ntpd
##国家授时中心
server 210.72.145.44

```

```
其他：
ntpq -p 查看时间同步状态
详解：
标志	   含义
*		响应的NTP服务器和最精确的服务器
+		响应这个查询请求的NTP服务器
blank(空格)	没有响应的NTP服务器
remote	响应这个请求的NTP服务器的名称
refid	NTP服务器使用的更高一级服务器的名称
st		正在响应请求的NTP服务器的级别
when	上一次成功请求之后到现在的秒数
poll	本地和远程服务器多少时间进行一次同步，单位秒，在一开始运行NTP的时候这个poll值会比较小，		   服务器同步的频率大，可以尽快调整到正确的时间范围，之后poll值会逐渐增大，同步的频率也就		会相应减小
reach	用来测试能否和服务器连接，是一个八进制值，每成功连接一次它的值就会增加
delay	从本地机发送同步要求到ntp服务器的往返时间
offset	主机通过NTP时钟同步与所同步时间源的时间偏移量，单位为毫秒，offset越接近于0，主机和ntp		 服务器的时间越接近
jitter	统计了在特定个连续的连接数里offset的分布情况。简单地说这个数值的绝对值越小，主机的时间		  就越精确
```

